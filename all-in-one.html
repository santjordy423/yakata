<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ€ æƒ°ã¨ç‹ã®é¤¨</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Noto+Serif+JP:wght@300;400;600&display=swap" rel="stylesheet">
<style>
/* ===== SHARED ===== */
:root {
  --gold: #c9a84c;
  --gold-light: #f0d080;
  --gold-dim: #7a6030;
  --black: #06060a;
  --dark2: #161420;
  --red: #8b1a1a;
  --text: #e8dcc0;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Noto Serif JP', serif;
  background: var(--black);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 40% at 50% 0%, #1a1408 0%, transparent 70%),
    repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(201,168,76,0.015) 40px, rgba(201,168,76,0.015) 41px);
  pointer-events: none;
  z-index: 0;
}

/* ===== SCREENS ===== */
.screen { display: none; position: relative; z-index: 1; }
.screen.active { display: block; }

/* ===== BACK BUTTON ===== */
.back-btn {
  position: fixed;
  top: 16px;
  left: 16px;
  z-index: 100;
  background: rgba(6,6,10,0.85);
  border: 1px solid #2a2520;
  color: var(--gold-dim);
  font-family: 'Noto Serif JP', serif;
  font-size: 0.75rem;
  letter-spacing: 0.15em;
  padding: 7px 14px;
  cursor: pointer;
  transition: all 0.2s;
  backdrop-filter: blur(4px);
}
.back-btn:hover { border-color: var(--gold); color: var(--gold); }
.back-btn.hidden { display: none; }

/* ===== TOP PAGE ===== */
.top-container {
  max-width: 540px;
  margin: 0 auto;
  padding: 60px 20px 80px;
}
.header { text-align: center; margin-bottom: 56px; }
.header-icon {
  font-size: 2.8rem;
  display: block;
  margin-bottom: 12px;
  animation: float 4s ease-in-out infinite;
  filter: drop-shadow(0 0 16px rgba(201,168,76,0.5));
}
@keyframes float {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-8px); }
}
.site-label {
  font-family: 'Cinzel Decorative', serif;
  font-size: 0.7rem;
  letter-spacing: 0.4em;
  color: var(--gold-dim);
  text-transform: uppercase;
  margin-bottom: 10px;
}
h1.site-title {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--gold-light);
  letter-spacing: 0.2em;
  text-shadow: 0 0 30px rgba(201,168,76,0.35);
  margin-bottom: 10px;
}
.header-desc { font-size: 0.75rem; color: #555; letter-spacing: 0.15em; line-height: 1.8; }

.divider {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 32px;
}
.divider::before, .divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--gold-dim), transparent);
}
.divider span { color: var(--gold); font-size: 0.65rem; letter-spacing: 0.25em; white-space: nowrap; }

.cards {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 14px;
}
.card {
  display: block;
  background: #0e0d12;
  border: 1px solid #1e1c28;
  border-radius: 12px;
  padding: 24px 18px;
  text-decoration: none;
  color: var(--text);
  position: relative;
  overflow: hidden;
  transition: all 0.3s;
  cursor: pointer;
  text-align: left;
  width: 100%;
  font-family: 'Noto Serif JP', serif;
}
.card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, rgba(201,168,76,0.05), transparent 60%);
  opacity: 0;
  transition: opacity 0.3s;
}
.card:hover { border-color: var(--gold-dim); transform: translateY(-3px); box-shadow: 0 8px 32px rgba(0,0,0,0.5), 0 0 20px rgba(201,168,76,0.08); }
.card:hover::before { opacity: 1; }
.card.soon { opacity: 0.4; cursor: default; pointer-events: none; }
.card-icon { font-size: 2.2rem; display: block; margin-bottom: 12px; filter: drop-shadow(0 0 8px rgba(201,168,76,0.3)); }
.card-title { font-size: 0.9rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.08em; margin-bottom: 6px; line-height: 1.4; }
.card-desc { font-size: 0.72rem; color: #666; line-height: 1.7; letter-spacing: 0.04em; }
.card-tag { display: inline-block; margin-top: 12px; padding: 3px 8px; border: 1px solid #2a2520; border-radius: 10px; font-size: 0.62rem; color: var(--gold-dim); letter-spacing: 0.1em; }
.soon-badge { position: absolute; top: 10px; right: 10px; font-size: 0.55rem; color: #444; letter-spacing: 0.1em; border: 1px solid #2a2520; padding: 2px 6px; border-radius: 4px; }
.site-footer { text-align: center; margin-top: 56px; font-size: 0.65rem; color: #333; letter-spacing: 0.15em; line-height: 2; }
.site-footer span { color: var(--gold-dim); }

/* ===== LAZY SCOREBOARD ===== */
.lazy-container {
  max-width: 480px;
  margin: 0 auto;
  padding: 72px 20px 60px;
  font-family: 'Hiragino Kaku Gothic ProN', 'Meiryo', sans-serif;
}
.lazy-container h2 { text-align: center; font-size: 1.6rem; margin-bottom: 4px; color: #c9b8ff; letter-spacing: 0.1em; }
.lazy-subtitle { text-align: center; font-size: 0.75rem; color: #666; margin-bottom: 24px; }
.lcard { background: #1a1a2e; border-radius: 16px; padding: 20px; margin-bottom: 16px; border: 1px solid #2a2a4a; }
.questions label { display: block; font-size: 0.85rem; color: #aaa; margin-bottom: 6px; margin-top: 14px; }
.questions label:first-child { margin-top: 0; }
.slider-row { display: flex; align-items: center; gap: 10px; }
input[type=range] { flex: 1; accent-color: #9b7fff; height: 6px; }
.slider-val { font-size: 0.9rem; color: #c9b8ff; width: 28px; text-align: right; }
.checkboxes { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 6px; }
.checkboxes label { background: #252540; border: 1px solid #3a3a6a; border-radius: 20px; padding: 5px 12px; font-size: 0.8rem; cursor: pointer; transition: all 0.15s; margin: 0; color: #ccc; }
.checkboxes input { display: none; }
.checkboxes label:has(input:checked) { background: #3d2d7a; border-color: #9b7fff; color: #fff; }
.lazy-btn { width: 100%; padding: 14px; background: linear-gradient(135deg, #6a4fc8, #9b7fff); border: none; border-radius: 12px; color: white; font-size: 1rem; font-weight: bold; cursor: pointer; letter-spacing: 0.05em; transition: opacity 0.2s; font-family: inherit; }
.lazy-btn:hover { opacity: 0.85; }
.result-box { display: none; text-align: center; padding: 24px 16px; }
.rank-emoji { font-size: 3.5rem; margin-bottom: 8px; }
.rank-title { font-size: 1.5rem; font-weight: bold; color: #c9b8ff; margin-bottom: 6px; }
.rank-desc { font-size: 0.85rem; color: #999; margin-bottom: 16px; line-height: 1.6; white-space: pre-line; }
.score-display { font-size: 2.5rem; font-weight: bold; color: #fff; margin-bottom: 4px; }
.score-label { font-size: 0.75rem; color: #666; margin-bottom: 20px; }
.history-title { font-size: 0.85rem; color: #888; margin-bottom: 10px; text-align: left; }
.history-list { list-style: none; }
.history-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #222; font-size: 0.8rem; }
.history-item:last-child { border-bottom: none; }
.history-date { color: #666; }
.history-rank { color: #c9b8ff; }
.history-score { color: #fff; font-weight: bold; }
.empty-history { color: #555; font-size: 0.8rem; text-align: center; padding: 12px; }
.lmeter { width: 100%; height: 8px; background: #252540; border-radius: 4px; margin: 12px 0; overflow: hidden; }
.lmeter-fill { height: 100%; border-radius: 4px; background: linear-gradient(90deg, #4a90ff, #9b7fff, #ff6b9d); transition: width 0.6s ease; }

/* ===== GILGAMESH ===== */
.gil-container {
  max-width: 480px;
  margin: 0 auto;
  padding: 72px 20px 60px;
}
.gil-header { text-align: center; margin-bottom: 40px; }
.crown { font-size: 2.4rem; display: block; margin-bottom: 8px; filter: drop-shadow(0 0 12px rgba(201,168,76,0.6)); animation: float 3s ease-in-out infinite; }
.g-title { font-family: 'Cinzel Decorative', serif; font-size: 0.85rem; letter-spacing: 0.3em; color: var(--gold); text-transform: uppercase; margin-bottom: 4px; }
h2.g-h2 { font-size: 1.7rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.15em; text-shadow: 0 0 30px rgba(201,168,76,0.4); }
.g-subtitle { font-size: 0.7rem; color: var(--gold-dim); margin-top: 6px; letter-spacing: 0.2em; }
.g-divider { display: flex; align-items: center; gap: 12px; margin: 28px 0; }
.g-divider::before, .g-divider::after { content: ''; flex: 1; height: 1px; background: linear-gradient(90deg, transparent, var(--gold-dim), transparent); }
.g-divider span { color: var(--gold); font-size: 0.7rem; letter-spacing: 0.2em; white-space: nowrap; }
.q-block { margin-bottom: 22px; }
.q-label { font-size: 0.78rem; color: var(--gold-dim); letter-spacing: 0.15em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
.q-label::before { content: 'â—†'; color: var(--gold); font-size: 0.5rem; }
.q-hint { font-size: 0.65rem; color: #444; letter-spacing: 0.05em; }
.opts { display: flex; flex-direction: column; gap: 6px; }
.opts.multi { flex-direction: row; flex-wrap: wrap; gap: 6px; }
.gopt {
  background: var(--dark2); border: 1px solid #2a2520; border-radius: 4px;
  padding: 10px 14px; font-size: 0.82rem; font-family: 'Noto Serif JP', serif;
  color: #888; cursor: pointer; transition: all 0.2s; text-align: left; letter-spacing: 0.05em;
}
.opts.multi .gopt { padding: 7px 12px; font-size: 0.78rem; border-radius: 20px; }
.gopt:hover { border-color: var(--gold-dim); color: var(--text); background: #1a1810; }
.gopt.selected { border-color: var(--gold); color: var(--gold-light); background: linear-gradient(90deg, #1e1a0a, #1a1810); box-shadow: 0 0 10px rgba(201,168,76,0.15); }
.divine-btn {
  width: 100%; margin-top: 32px; padding: 16px; background: transparent;
  border: 1px solid var(--gold); color: var(--gold-light); font-family: 'Noto Serif JP', serif;
  font-size: 0.95rem; letter-spacing: 0.3em; cursor: pointer; position: relative;
  overflow: hidden; transition: all 0.3s;
}
.divine-btn::before { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(201,168,76,0.08), transparent); transform: translateX(-100%); transition: transform 0.5s; }
.divine-btn:hover::before { transform: translateX(100%); }
.divine-btn:hover { background: rgba(201,168,76,0.06); box-shadow: 0 0 20px rgba(201,168,76,0.2); }
.divine-btn:disabled { border-color: #333; color: #444; cursor: not-allowed; }
.divine-btn:disabled::before { display: none; }
.g-result { display: none; margin-top: 40px; }
.g-frame { border: 1px solid var(--gold-dim); position: relative; padding: 32px 24px; background: linear-gradient(160deg, #100e08, #0e0d10); }
.g-frame::before, .g-frame::after { content: 'â—ˆ'; position: absolute; color: var(--gold); font-size: 0.8rem; }
.g-frame::before { top: -8px; left: -4px; }
.g-frame::after { bottom: -8px; right: -4px; }
.mood-icon { font-size: 3.8rem; display: block; text-align: center; margin-bottom: 12px; animation: gappear 0.5s ease-out; filter: drop-shadow(0 0 16px rgba(201,168,76,0.5)); }
@keyframes gappear { from { transform: scale(0.5) rotate(-10deg); opacity: 0; } to { transform: scale(1) rotate(0); opacity: 1; } }
.mood-title { text-align: center; font-size: 1.4rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.2em; margin-bottom: 6px; text-shadow: 0 0 20px rgba(201,168,76,0.4); }
.mood-level { text-align: center; font-family: 'Cinzel Decorative', serif; font-size: 0.65rem; color: var(--gold-dim); letter-spacing: 0.3em; margin-bottom: 20px; }
.mood-meter { display: flex; gap: 4px; justify-content: center; margin-bottom: 16px; }
.mpip { width: 20px; height: 4px; background: #222; border-radius: 2px; }
.mpip.on { background: var(--gold); box-shadow: 0 0 6px rgba(201,168,76,0.5); }
.mpip.danger { background: var(--red); box-shadow: 0 0 6px rgba(139,26,26,0.6); }
.random-note { text-align: center; font-size: 0.68rem; color: #4a3f28; margin-bottom: 18px; letter-spacing: 0.08em; font-style: italic; }
.verdict { font-size: 0.88rem; line-height: 2; color: var(--text); text-align: center; margin-bottom: 18px; letter-spacing: 0.05em; white-space: pre-line; }
.gil-quote { border-top: 1px solid #2a2520; padding-top: 16px; font-size: 0.78rem; color: var(--gold-dim); text-align: center; line-height: 1.8; font-style: italic; letter-spacing: 0.1em; }
.gil-quote::before { content: 'ã€Œ'; }
.gil-quote::after { content: 'ã€'; }
.today-tip { margin-top: 16px; padding: 12px; background: rgba(201,168,76,0.04); border-left: 2px solid var(--gold-dim); font-size: 0.78rem; color: #999; line-height: 1.7; letter-spacing: 0.05em; }
.retry-btn { display: block; width: 100%; margin-top: 20px; padding: 10px; background: transparent; border: 1px solid #2a2520; color: #555; font-family: 'Noto Serif JP', serif; font-size: 0.75rem; letter-spacing: 0.2em; cursor: pointer; transition: all 0.2s; }
.retry-btn:hover { border-color: var(--gold-dim); color: var(--gold-dim); }
.g-hist { margin-top: 36px; }
.g-hitem { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #141210; font-size: 0.75rem; }
.g-hitem:last-child { border-bottom: none; }
.h-date { color: #444; }
.h-mood { color: var(--gold-dim); }
.h-score { color: var(--gold); font-size: 0.7rem; }
.no-history { font-size: 0.75rem; color: #333; text-align: center; padding: 12px 0; letter-spacing: 0.1em; }
</style>
</head>
<body>

<button class="back-btn hidden" id="backBtn" onclick="showTop()">â† ã‚‚ã©ã‚‹</button>

<!-- TOP PAGE -->
<div class="screen active" id="screen-top">
  <div class="top-container">
    <div class="header">
      <span class="header-icon">ğŸ›ï¸</span>
      <div class="site-label">My Tiny App Collection</div>
      <h1 class="site-title">æ€ æƒ°ã¨ç‹ã®é¤¨</h1>
      <p class="header-desc">åœ¨å®…å‹¤å‹™ã¨æ¨ã—æ´»ã®ãŸã‚ã®ãƒ„ãƒ¼ãƒ«é›†<br>éšæ™‚æ›´æ–°äºˆå®š</p>
    </div>
    <div class="divider"><span>â—† APPS â—†</span></div>
    <div class="cards">
      <button class="card" onclick="showScreen('lazy')">
        <span class="card-icon">ğŸ˜´</span>
        <div class="card-title">æ€ æƒ°ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰</div>
        <div class="card-desc">ä»Šæ—¥ã®ã‚µãƒœã‚Šå…·åˆã‚’è¨ºæ–­ã—ã¦ç§°å·ã‚’ã‚‚ã‚‰ã†</div>
        <span class="card-tag">åœ¨å®…å‹¤å‹™</span>
      </button>
      <button class="card" onclick="showScreen('gil')">
        <span class="card-icon">ğŸ‘‘</span>
        <div class="card-title">ç‹ã®æ©Ÿå«Œäºˆå ±</div>
        <div class="card-desc">ä»Šæ—¥ã®ã‚®ãƒ«ã‚¬ãƒ¡ãƒƒã‚·ãƒ¥ã®æ©Ÿå«Œã‚’ç†ä¸å°½ã«å ã†</div>
        <span class="card-tag">æ¨ã—æ´»</span>
      </button>
      <a class="card" href="https://santjordy.my.canva.site" target="_blank" style="text-decoration:none;">
        <span class="card-icon">ğŸ…</span>
        <div class="card-title">å‹æ‰‹ã«ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­</div>
        <div class="card-desc">ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ã€å‹æ‰‹ã«ã‚„ã£ã¦ãã‚Œã‚‹</div>
        <span class="card-tag">é›†ä¸­</span>
      </a>
      <a class="card" href="https://santjordy.my.canva.site/c20q8y605r5mw6n1" target="_blank" style="text-decoration:none;">
        <span class="card-icon">ğŸ’¥</span>
        <div class="card-title">ã‚¿ã‚¹ã‚¯ç²‰ç •æ©Ÿ</div>
        <div class="card-desc">å¤§ããªã‚¿ã‚¹ã‚¯ã‚’æ¥µå°ã‚¹ãƒ†ãƒƒãƒ—ã«åˆ†è§£ã™ã‚‹</div>
        <span class="card-tag">ä»•äº‹</span>
      </a>
    </div>
    <div class="site-footer"><span>æ€ æƒ°ã¨ç‹ã®é¤¨</span> â€” a collection of useless but necessary tools</div>
  </div>
</div>

<!-- LAZY SCOREBOARD -->
<div class="screen" id="screen-lazy">
  <div class="lazy-container">
    <h2>ğŸ˜´ æ€ æƒ°ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰</h2>
    <p class="lazy-subtitle">ä»Šæ—¥ã®ã‚µãƒœã‚Šå…·åˆã‚’æ­£ç›´ã«ç”³å‘Šã—ã¦ãã ã•ã„</p>
    <div class="lcard">
      <div class="questions">
        <label>ä»•äº‹ã—ã¦ãŸå‰²åˆï¼ˆ0 = å®Œå…¨ç„¡è·ãƒ¢ãƒ¼ãƒ‰ã€10 = çœŸé¢ç›®ã«åƒã„ãŸï¼‰</label>
        <div class="slider-row">
          <input type="range" id="work" min="0" max="10" value="5" oninput="document.getElementById('work-val').textContent=this.value">
          <span class="slider-val" id="work-val">5</span>
        </div>
        <label>ä»Šæ—¥ã‚„ã‚‰ã‹ã—ãŸã“ã¨ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</label>
        <div class="checkboxes">
          <label><input type="checkbox" class="sin" value="15"><span>å¸ƒå›£ã‹ã‚‰å‡ºã‚‹ã®ã«1æ™‚é–“ä»¥ä¸Šã‹ã‹ã£ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="10"><span>Twitterã§æº¶ã‘ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="12"><span>ä¼šè­°ä¸­ã«åˆ¥ã‚¿ãƒ–è¦‹ã¦ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="8"><span>æ˜¼ã”ã¯ã‚“ãŒå¤•æ–¹ã ã£ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="10"><span>äºˆå®šã‚’æ˜æ—¥ã«æŒã¡è¶Šã—ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="15"><span>ä»•äº‹ä¸­ã«AIã¨é›‘è«‡ã—ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="7"><span>ç€æ›¿ãˆãªã‹ã£ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="9"><span>åŒäººæ´»å‹•ã—ã¦ãŸï¼ˆæ¥­å‹™æ™‚é–“ä¸­ã«ï¼‰</span></label>
          <label><input type="checkbox" class="sin" value="5"><span>é–“é£ŸãŒæ­¢ã¾ã‚‰ãªã‹ã£ãŸ</span></label>
          <label><input type="checkbox" class="sin" value="20"><span>æ°—ã¥ã„ãŸã‚‰å¤œã ã£ãŸ</span></label>
        </div>
        <label>ä»Šã®è‡ªå·±è©•ä¾¡</label>
        <div class="slider-row">
          <input type="range" id="self" min="0" max="10" value="5" oninput="document.getElementById('self-val').textContent=this.value">
          <span class="slider-val" id="self-val">5</span>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:0.7rem;color:#555;margin-top:2px;">
          <span>ã¾ã‚ãˆãˆã‚„ã‚</span><span>åçœã—ã¦ã„ã‚‹</span>
        </div>
      </div>
    </div>
    <button class="lazy-btn" onclick="calcScore()">ğŸ”® ä»Šæ—¥ã®æ€ æƒ°ã‚’è¨ºæ–­ã™ã‚‹</button>
    <div class="lcard result-box" id="result">
      <div class="rank-emoji" id="r-emoji"></div>
      <div class="rank-title" id="r-title"></div>
      <div class="rank-desc" id="r-desc"></div>
      <div class="score-display" id="r-score"></div>
      <div class="score-label">æ€ æƒ°ãƒã‚¤ãƒ³ãƒˆ</div>
      <div class="lmeter"><div class="lmeter-fill" id="r-meter"></div></div>
    </div>
    <div class="lcard">
      <div class="history-title">ğŸ“œ æ€ æƒ°ã®æ­´å²</div>
      <ul class="history-list" id="lazy-history"></ul>
    </div>
  </div>
</div>

<!-- GILGAMESH -->
<div class="screen" id="screen-gil">
  <div class="gil-container">
    <div class="gil-header">
      <span class="crown">â™›</span>
      <div class="g-title">King's Mood Oracle</div>
      <h2 class="g-h2">ç‹ã®æ©Ÿå«Œäºˆå ±</h2>
      <div class="g-subtitle">â€” ä»Šæ—¥ã®ç‹ã¯ã”æ©Ÿå«Œæ–œã‚ã‹ã€ãã‚Œã¨ã‚‚ â€”</div>
    </div>
    <div class="g-divider"><span>â—† ç¾åœ¨ã®çŠ¶æ³ã‚’ç”³å‘Šã›ã‚ˆ â—†</span></div>

    <div class="q-block">
      <div class="q-label">ä»Šæ—¥ã®å¤©æ°—</div>
      <div class="opts single" data-q="weather">
        <button class="gopt" data-v="2">â˜€ï¸ æ™´ã‚Œï¼ˆç‹ã®é»„é‡‘ã®å¦‚ã—ï¼‰</button>
        <button class="gopt" data-v="1">â›… æ›‡ã‚Š</button>
        <button class="gopt" data-v="-1">ğŸŒ§ï¸ é›¨ï¼ˆé¬±é™¶ã—ã„ï¼‰</button>
        <button class="gopt" data-v="0">ğŸŒ©ï¸ åµï¼ˆç‹ã¯åµã‚’å¥½ã‚€ï¼‰</button>
      </div>
    </div>
    <div class="q-block">
      <div class="q-label">ä»Šæ—¥ã®è‡ªåˆ†ã®å‡ºæ¥æ „ãˆ</div>
      <div class="opts single" data-q="self">
        <button class="gopt" data-v="3">å®Œç’§ã ã£ãŸï¼ˆç‹ã«è¿‘ã„ï¼‰</button>
        <button class="gopt" data-v="1">ã¾ã‚ã¾ã‚ã ã£ãŸ</button>
        <button class="gopt" data-v="-1">ã ã‚ã ã‚ã ã£ãŸ</button>
        <button class="gopt" data-v="-3">èããª</button>
      </div>
    </div>
    <div class="q-block">
      <div class="q-label">ä»Šæ—¥ã®é›‘å¿µ <span class="q-hint">ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</span></div>
      <div class="opts multi" data-q="noise">
        <button class="gopt" data-v="3">Twitterã§æ¨ã—ã®ä¾›çµ¦ãŒã‚ã£ãŸ</button>
        <button class="gopt" data-v="-2">SNSã§ä¸æ¯›ãªè­°è«–ã‚’è¦‹ãŸ</button>
        <button class="gopt" data-v="-1">å«Œãªã“ã¨ãŒã‚ã£ãŸ</button>
        <button class="gopt" data-v="1">é™ã‹ãªä¸€æ—¥ã ã£ãŸ</button>
        <button class="gopt" data-v="-3">åœ°é›·ã‚’è¸ã‚“ã </button>
        <button class="gopt" data-v="2">è‰¯ã„ã”é£¯ã‚’é£Ÿã¹ãŸ</button>
        <button class="gopt" data-v="-1">çœ ã„</button>
        <button class="gopt" data-v="2">å‰µä½œãŒæ—ã£ãŸ</button>
        <button class="gopt" data-v="-2">æ¨ã—ãŒå…¬å¼ã§é›‘ã«æ‰±ã‚ã‚Œã¦ã„ãŸ</button>
        <button class="gopt" data-v="1">ã„ã„å¤¢ã‚’è¦‹ãŸ</button>
        <button class="gopt" data-v="-1">é ­ç—›ãŒã™ã‚‹</button>
        <button class="gopt" data-v="3">ç¥çµµå¸«ã®ç¥çµµã‚’è¦‹ãŸ</button>
        <button class="gopt" data-v="-2">èª²é‡‘ã—ãŸï¼ˆå¾Œæ‚”ã‚ã‚Šï¼‰</button>
        <button class="gopt" data-v="2">èª²é‡‘ã—ãŸï¼ˆå¾Œæ‚”ãªã—ï¼‰</button>
        <button class="gopt" data-v="-1">ãªã‚“ã‹è™šç„¡</button>
        <button class="gopt" data-v="1">ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã†ã¾ã‹ã£ãŸ</button>
        <button class="gopt" data-v="-2">æ¨ã—ã‚«ãƒ—ã®NLãŒæµã‚Œã¦ããŸ</button>
        <button class="gopt" data-v="2">å¸ƒå›£ãŒæ°—æŒã¡ã‚ˆã‹ã£ãŸ</button>
        <button class="gopt" data-v="-1">èª¤å­—ã—ãŸ</button>
        <button class="gopt" data-v="1">è‰¯ã„BGMã‚’è¦‹ã¤ã‘ãŸ</button>
      </div>
    </div>
    <div class="q-block">
      <div class="q-label">ä»Šæ—¥ã®ç‹ï¼ˆã‚®ãƒ«ã‚¬ãƒ¡ãƒƒã‚·ãƒ¥ï¼‰ã¸ã®è²¢ãç‰©</div>
      <div class="opts single" data-q="tribute">
        <button class="gopt" data-v="4">åŒäººèªŒãƒ»ã‚°ãƒƒã‚ºã‚’ä½œã£ãŸ or è¦‹ãŸ</button>
        <button class="gopt" data-v="2">äºŒæ¬¡å‰µä½œã‚’Twitterã§æ˜ã£ãŸ</button>
        <button class="gopt" data-v="0">å­˜åœ¨ã‚’æ€ã„å‡ºã—ãŸç¨‹åº¦</button>
        <button class="gopt" data-v="-2">ä»Šæ—¥ã¯ä»–ã®æ¨ã—ã«æµ®æ°—ã—ãŸ</button>
      </div>
    </div>
    <div class="q-block">
      <div class="q-label">ä»Šã®æ™‚é–“å¸¯</div>
      <div class="opts single" data-q="time">
        <button class="gopt" data-v="1">æœï¼ˆç‹ã¯å¤œæ˜ã‘ã‚’å«Œã†ï¼‰</button>
        <button class="gopt" data-v="2">æ˜¼ï¼ˆé»„é‡‘ã®æ™‚ï¼‰</button>
        <button class="gopt" data-v="1">å¤•æ–¹</button>
        <button class="gopt" data-v="3">æ·±å¤œï¼ˆçœŸã®ç‹ã¯å¤œã«èªã‚‹ï¼‰</button>
      </div>
    </div>

    <button class="divine-btn" id="divineBtn" onclick="divine()" disabled>â—† &nbsp;ç‹ã®æ©Ÿå«Œã‚’å ã†&nbsp; â—†</button>

    <div class="g-result" id="g-result">
      <div class="g-frame">
        <span class="mood-icon" id="moodIcon"></span>
        <div class="mood-title" id="moodTitle"></div>
        <div class="mood-level" id="moodLevel"></div>
        <div class="mood-meter" id="moodMeter"></div>
        <div class="random-note" id="randomNote"></div>
        <div class="verdict" id="verdict"></div>
        <div class="gil-quote" id="gilQuote"></div>
        <div class="today-tip" id="todayTip"></div>
      </div>
      <button class="retry-btn" onclick="resetGil()">â€” ã‚‚ã†ä¸€åº¦å ã† â€”</button>
    </div>

    <div class="g-hist">
      <div class="g-divider"><span>â—† éå»ã®å¾¡æ©Ÿå«Œ â—†</span></div>
      <div id="gil-history"></div>
    </div>
  </div>
</div>

<script>
// ===== NAVIGATION =====
function showScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-' + name).classList.add('active');
  document.getElementById('backBtn').classList.remove('hidden');
  window.scrollTo(0, 0);
  if (name === 'lazy') renderLazyHistory();
  if (name === 'gil') renderGilHistory();
}
function showTop() {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-top').classList.add('active');
  document.getElementById('backBtn').classList.add('hidden');
  window.scrollTo(0, 0);
}

// ===== LAZY SCOREBOARD =====
const ranks = [
  { min: 0,  max: 20,  emoji: 'ğŸ’¼', title: 'å‹¤å‹‰å¸‚æ°‘',     desc: 'ä»Šæ—¥ã¯ã¡ã‚ƒã‚“ã¨ã—ã¦ãŸã‚“ã§ã™ã­ã€‚\nãªã‚“ã‹æ€–ã„ã§ã™ã­ã€‚' },
  { min: 21, max: 40,  emoji: 'ğŸ˜', title: 'å°ç‹¡ã„ç¤¾ä¼šäºº', desc: 'ä¸Šæ‰‹ã„ã“ã¨ã‚„ã£ã¦ã¾ã™ã­ã€‚\nç”Ÿãæ–¹ã¨ã—ã¦æ­£ã—ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚' },
  { min: 41, max: 60,  emoji: 'ğŸ›‹ï¸', title: 'åœ¨å®…ã®ç”³ã—å­', desc: 'åœ¨å®…å‹¤å‹™ã®æœ¬æ¥ã®å§¿ãŒã“ã“ã«ã€‚\nãƒªãƒ“ãƒ³ã‚°ã¯ã‚ãªãŸã®ã‚‚ã®ã€‚' },
  { min: 61, max: 80,  emoji: 'ğŸŒ«ï¸', title: 'æ™‚é–“æº¶è§£è€…',   desc: 'æ°—ã¥ã„ãŸã‚‰å¤•æ–¹ã€ã‚ˆãã‚ã‚‹ã€‚\næ™‚é–“ã®æ¦‚å¿µãŒè–„ã‚Œã¦ãã¦ã„ã‚‹ã€‚' },
  { min: 81, max: 100, emoji: 'ğŸ‘‘', title: 'æ€ æƒ°ã®è³¢è€…',   desc: 'ã“ã‚Œã¯ã‚‚ã†æ‰èƒ½ã§ã™ã€‚\nã‚µãƒœã‚‹ã“ã¨ã¸ã®å…¨åŠ›æŠ•çƒã‚’æ„Ÿã˜ã‚‹ã€‚' },
  { min: 101,max: 999, emoji: 'ğŸŒŒ', title: 'æ€ æƒ°ã®ç¥',     desc: 'æ¸¬å®šä¸èƒ½ãªé ˜åŸŸã«é”ã—ã¾ã—ãŸã€‚\nä»Šæ—¥ã‚ãªãŸã¯ä½•ã‹ã‚’è¶…ãˆãŸã€‚' },
];

function calcScore() {
  const work = 10 - parseInt(document.getElementById('work').value);
  const self = parseInt(document.getElementById('self').value);
  const sins = [...document.querySelectorAll('.sin:checked')].reduce((a, el) => a + parseInt(el.value), 0);
  const score = Math.round(work * 3 + self * 2 + sins);
  const rank = ranks.find(r => score >= r.min && score <= r.max) || ranks[ranks.length - 1];
  document.getElementById('r-emoji').textContent = rank.emoji;
  document.getElementById('r-title').textContent = rank.title;
  document.getElementById('r-desc').textContent = rank.desc;
  document.getElementById('r-score').textContent = score;
  document.getElementById('r-meter').style.width = Math.min(score, 100) + '%';
  const result = document.getElementById('result');
  result.style.display = 'block';
  result.scrollIntoView({ behavior: 'smooth' });
  const history = JSON.parse(localStorage.getItem('lazy-history') || '[]');
  const today = new Date().toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric' });
  history.unshift({ date: today, score, title: rank.title, emoji: rank.emoji });
  if (history.length > 10) history.pop();
  localStorage.setItem('lazy-history', JSON.stringify(history));
  renderLazyHistory();
}

function renderLazyHistory() {
  const history = JSON.parse(localStorage.getItem('lazy-history') || '[]');
  const el = document.getElementById('lazy-history');
  if (history.length === 0) { el.innerHTML = '<div class="empty-history">ã¾ã è¨˜éŒ²ãŒã‚ã‚Šã¾ã›ã‚“</div>'; return; }
  el.innerHTML = history.map(h => `<li class="history-item"><span class="history-date">${h.date}</span><span class="history-rank">${h.emoji} ${h.title}</span><span class="history-score">${h.score}pt</span></li>`).join('');
}

// ===== GILGAMESH =====
const randomEvents = [
  { text: 'ä»Šæ—¥ã¯æœˆãŒæ¬ ã‘ã¦ã„ã‚‹', delta: -3 },
  { text: 'ç‹ã®æ°—åˆ†ãŒå®‡å®™ã®æ³•å‰‡ã«å¾“ã„æ‚ªåŒ–ã—ãŸ', delta: -5 },
  { text: 'èª°ã‹ãŒç‹ã®åã‚’å‘¼ã³æ¨ã¦ã«ã—ãŸï¼ˆã©ã“ã‹ã§ï¼‰', delta: -4 },
  { text: 'ç©ºæ°—ã®æ¹¿åº¦ãŒç‹ã®å¥½ã¿ã§ã¯ãªã„', delta: -2 },
  { text: 'ç¥ã€…ãŒä»Šæ—¥ã®ç‹ã«å¾®ç¬‘ã‚“ã ', delta: +4 },
  { text: 'ç‹ã®è²¡å®åº«ãŒä»Šæ—¥ã‚‚å®Œç’§ã§ã‚ã‚‹', delta: +3 },
  { text: 'è‹±é›„ãŒä¸€äººã©ã“ã‹ã§æˆ¦ã„ã‚’æŒ‘ã‚“ã§ã„ã‚‹ï¼ˆç‹ã¯èˆˆå‘³ãªã—ï¼‰', delta: -1 },
  { text: 'ç‰¹ã«ä½•ã‚‚ãªã„ã€‚ã ã‹ã‚‰ã“ãé€€å±ˆ', delta: -2 },
  { text: 'ç‹ã¯ä»Šæ—¥ã€å·±ã®å®Œç’§ã•ã‚’å†ç¢ºèªã—ãŸ', delta: +5 },
  { text: 'ã‚¨ãƒ«ã‚­ãƒ‰ã‚¥ã®å¤¢ã‚’è¦‹ãŸï¼ˆç‹ã¯å¦å®šã™ã‚‹ï¼‰', delta: -3 },
  { text: 'é›‘ç¨®ã©ã‚‚ãŒé¨’ãŒã—ã„', delta: -3 },
  { text: 'ä»Šæ—¥ã®æ˜Ÿã®ä¸¦ã³ãŒç‹ã‚’è®ƒãˆã¦ã„ã‚‹', delta: +4 },
  { text: 'èª°ã‹ãŒç‹ã‚’ã€Œã‚®ãƒ«ãã‚“ã€ã¨å‘¼ã‚“ã ', delta: -6 },
  { text: 'ç‹ã®é£Ÿäº‹ãŒä»Šæ—¥ã¯ç‰¹ã«è±ªå‹¢ã ã£ãŸ', delta: +3 },
  { text: 'ä½•è€…ã‹ãŒç‹ã®å‰ä¸–ã‚’è©®ç´¢ã—ãŸ', delta: -4 },
  { text: 'é¢¨ãŒä»Šæ—¥ã¯æ°—æŒã¡ã‚ˆã‹ã£ãŸ', delta: +2 },
  { text: 'ç‹ã®é»„é‡‘é§ã®è¼ããŒå¢—ã—ãŸï¼ˆæ°—ãŒã™ã‚‹ï¼‰', delta: +3 },
  { text: 'ãƒãƒ“ãƒ­ãƒ³ãŒä»Šæ—¥ã‚‚ç¾ã—ã„', delta: +2 },
  { text: 'èª°ã‹ãŒè‹±é›„ç‹ã®åŠŸç¸¾ã‚’ã€Œæ„å¤–ã¨çŸ¥ã‚‰ãªã„ã€ã¨è¨€ã£ãŸ', delta: -5 },
  { text: 'ä»Šæ—¥ã¯ãªãœã‹å…¨ã¦ãŒã©ã†ã§ã‚‚ã‚ˆã„', delta: -4 },
];

const moods = [
  { min: -999, max: -5, icon: 'âš”ï¸', title: 'çƒˆç«ã®æ€’ã‚Š', level: 'WRATH MODE', pips: 10, danger: true,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€åœ°ä¸Šã®å…¨ã¦ã«é£½ã„ã¦ãŠã‚‰ã‚Œã‚‹ã€‚\nå­˜åœ¨ã™ã‚‹ã ã‘ã§æ°—ã«éšœã‚‹ã‚‰ã—ã„ã€‚','è¿‘å¯„ã‚‹ãªã€‚ç‹ã®æ€’ã‚Šã¯ä»Šæ—¥ã€å®‡å®™è¦æ¨¡ã§ã‚ã‚‹ã€‚','æ©Ÿå«ŒãŒæ‚ªã„ã¨ã„ã†ãƒ¬ãƒ™ãƒ«ã§ã¯ãªã„ã€‚\nç‹ãŒã€Œä¸–ç•Œã”ã¨çµ‚ã‚ã‚‰ã›ã‚ˆã†ã€ã¨æ€ã£ã¦ã„ã‚‹é¡”ã‚’ã—ã¦ã„ã‚‹ã€‚'],
    quotes: ['é›‘ç¨®ã‚ã€ãã®ç¨‹åº¦ã§æˆ‘ã«è©±ã—ã‹ã‘ã‚‹ã¨ã¯ç¬‘æ­¢','ä»Šæ—¥ã®æˆ‘ã«è©±ã—ã‹ã‘ã‚‹ã“ã¨ã¯æ­»ã«ç­‰ã—ã„','ã“ã®ä¸–ã®å…¨ã¦ãŒæ°—ã«é£Ÿã‚ãªã„ã€‚å½“ç„¶ã ãŒ'],
    tips: ['âš  ä»Šæ—¥ã¯çµ¶å¯¾ã«è¿‘ã¥ã‹ãªã„ã“ã¨ã€‚æ¨ã—æ´»ã¯æ˜æ—¥ã«ã—ã‚ã€‚'] },
  { min: -4, max: 2, icon: 'ğŸ˜’', title: 'ä¸æ©Ÿå«Œ', level: 'LOW TOLERANCE', pips: 3, danger: true,
    verdicts: ['ç‹ã¯ä¸æº€è¶³ã®çŠ¶æ…‹ã«ã‚ã‚‹ã€‚\nä½•ã‹ãŒè¶³ã‚Šãªã„ã€‚è²¢ãç‰©ãŒè¶³ã‚Šãªã„ã€‚','ç‹ã®çœ‰é–“ã«ã—ã‚ãŒå¯„ã£ã¦ã„ã‚‹ã€‚\nä»Šæ—¥ã¯ä½•ã‚’ã‚„ã£ã¦ã‚‚è¤’ã‚ã‚‰ã‚Œãªã„æ—¥ã ã€‚','ã¾ãšã„ã€‚ç‹ãŒã€Œã¤ã¾ã‚‰ã¬ã€ã¨è¨€ã„å§‹ã‚ãŸã€‚'],
    quotes: ['æˆ‘ã‚’æ¥½ã—ã¾ã›ã¦ã¿ã‚ˆã€ã§ãã‚‹ãªã‚‰ã°','è²¢ãç‰©ãŒè¶³ã‚Šã¬','ã“ã®ç¨‹åº¦ã‹'],
    tips: ['âš¡ è‰¯ã„äºŒæ¬¡å‰µä½œã‚’è¦‹ã‚‹ã‹ã€æ¨ã—èªã‚Šã‚’ã™ã‚‹ã‹ã€‚ã¨ã«ã‹ãä½•ã‹ã‚’æ§ã’ã‚ˆã€‚'] },
  { min: 3, max: 9, icon: 'ğŸ˜', title: 'ã‚„ã‚„é€€å±ˆ', level: 'MILD BOREDOM', pips: 5, danger: false,
    verdicts: ['æ‚ªãã¯ãªã„ãŒã€è‰¯ãã‚‚ãªã„ã€‚\nç‹ã®åŸºæº–ã§ã¯ã€Œæ™®é€šã€ä»¥ä¸‹ã§ã‚ã‚‹ã€‚','ç‹ã¯ä»Šæ—¥ã€é€€å±ˆã—ã¦ã„ã‚‹ã€‚\né€€å±ˆãªç‹ã¯å±é™ºã ãŒã€ã¾ã çˆ†ç™ºã¯ã—ãªã„ã€‚','å‡ªã®çŠ¶æ…‹ã€‚\nåµã®å‰ãªã®ã‹ã€ãŸã ã®ç„¡é¢¨ãªã®ã‹ã¯ç‹ã®ã¿ãçŸ¥ã‚‹ã€‚'],
    quotes: ['ã¾ã‚ã€æ‚ªãã¯ãªã„ãª','é¢ç™½ã„ã‚‚ã®ã‚’é€£ã‚Œã¦ã“ã„','ãµã‚€â€¦'],
    tips: ['ğŸ“œ æ™®é€šã®æ—¥ã€‚æ¨ã—ã®ã“ã¨ã‚’è€ƒãˆãªãŒã‚‰éã”ã™ã¨å‰ã€‚'] },
  { min: 10, max: 16, icon: 'ğŸ˜', title: 'ã¾ãšã¾ãš', level: 'ACCEPTABLE', pips: 7, danger: false,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€æ¯”è¼ƒçš„ç©ã‚„ã‹ã§ã‚ã‚‹ã€‚\nã“ã‚Œã¯åƒè¼‰ä¸€é‡ã®ãƒãƒ£ãƒ³ã‚¹ã‹ã‚‚ã—ã‚Œãªã„ã€‚','ç‹ã®å£è§’ãŒã‚ãšã‹ã«ä¸ŠãŒã£ã¦ã„ã‚‹ã€‚\nä»Šæ—¥ã¯æ¨ã—æ´»ã«çµ¶å¥½ã®æ—¥ã ã€‚','ä¸Šæ©Ÿå«Œã¨ã¯è¨€ãˆãªã„ãŒã€ä¸æ©Ÿå«Œã§ã‚‚ãªã„ã€‚\nç‹ã®ã”åŠ è­·ãŒè–„ãã‹ã‹ã£ã¦ã„ã‚‹çŠ¶æ…‹ã€‚'],
    quotes: ['ä»Šæ—¥ã®æˆ‘ã¯æ°—åˆ†ãŒã„ã„ã€‚æ„Ÿè¬ã™ã‚‹ãŒã„ã„','ãµã€ã‚ˆãã‚„ã£ãŸ','æ‚ªããªã„ã€‚ç¶šã‘ã‚ˆ'],
    tips: ['âœ¨ ãƒãƒ£ãƒ³ã‚¹ã®æ—¥ï¼å‰µä½œæ´»å‹•ã‚„æ¨ã—æ´»ã«å‘ã„ã¦ã„ã‚‹ã€‚'] },
  { min: 17, max: 999, icon: 'ğŸ‘‘', title: 'çµ¶å¥½èª¿ãƒ»ç‹è€…ã®é¢¨æ ¼', level: 'MAXIMUM GILGAMESH', pips: 10, danger: false,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€å…¨ã¦ã‚’è‚¯å®šã—ã¦ã„ã‚‹ã€‚\nä¸–ç•Œã¯ç‹ã®ãŸã‚ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã¨ç¢ºä¿¡ã—ã¦ã„ã‚‹ã€‚','å®Œç’§ãªæ©Ÿå«Œã€‚\nç‹ãŒç¬‘ã£ã¦ã„ã‚‹ã€‚ã“ã®å…‰æ™¯ã¯åƒå¹´ã«ä¸€åº¦ã—ã‹è¦‹ã‚‰ã‚Œãªã„ã€‚','ä»Šæ—¥ã®ç‹ã¯ç„¡æ•µã ã€‚\nå¤ªé™½ã‚‚ç‹ã‚’è®ƒãˆã‚‹ãŸã‚ã«è¼ã„ã¦ã„ã‚‹ï¼ˆç‹è«‡ï¼‰ã€‚'],
    quotes: ['ãƒ•ãƒãƒã€ä»Šæ—¥ã®æˆ‘ã¯å®Œç’§ã ã€‚å½“ç„¶ã ãŒ','ä¸–ç•Œã‚ˆã€ã“ã‚ŒãŒç‹ã®æ©Ÿå«Œã¨ã„ã†ã‚‚ã®ã ','æˆ‘ãŒç¬‘ã£ã¦ã„ã‚‹ã†ã¡ã«ã€ä½•ã§ã‚‚ç”³ã—ã¦ã¿ã‚ˆ'],
    tips: ['ğŸŒŸ æœ€é«˜ã®æ—¥ï¼ä½•ã‚’ã‚„ã£ã¦ã‚‚ç‹ã®åŠ è­·ãŒã‚ã‚‹ã€‚é‡ã„äºŒæ¬¡å‰µä½œã‚‚èŒãˆèŒãˆãªåŒäººã‚‚å…¨éƒ¨OKã€‚'] },
];

function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

const gilAnswers = {};
let noiseScore = 0;

function initGil() {
  document.querySelectorAll('.opts.single').forEach(group => {
    group.querySelectorAll('.gopt').forEach(btn => {
      btn.addEventListener('click', () => {
        group.querySelectorAll('.gopt').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        gilAnswers[group.dataset.q] = parseInt(btn.dataset.v);
        checkGilReady();
      });
    });
  });
  document.querySelector('.opts.multi').querySelectorAll('.gopt').forEach(btn => {
    btn.addEventListener('click', () => {
      btn.classList.toggle('selected');
      noiseScore = [...document.querySelectorAll('.opts.multi .gopt.selected')].reduce((s, b) => s + parseInt(b.dataset.v), 0);
      gilAnswers['noise'] = noiseScore;
      checkGilReady();
    });
  });
  gilAnswers['noise'] = 0;
}

function checkGilReady() {
  const ready = ['weather','self','tribute','time'].every(q => gilAnswers[q] !== undefined);
  document.getElementById('divineBtn').disabled = !ready;
}

function divine() {
  const event = pick(randomEvents);
  const base = Object.values(gilAnswers).reduce((a,b) => a+b, 0);
  const final = base + event.delta;
  const mood = moods.find(m => final >= m.min && final <= m.max);
  document.getElementById('moodIcon').textContent = mood.icon;
  document.getElementById('moodTitle').textContent = mood.title;
  document.getElementById('moodLevel').textContent = mood.level;
  document.getElementById('verdict').textContent = pick(mood.verdicts);
  document.getElementById('gilQuote').textContent = pick(mood.quotes);
  document.getElementById('todayTip').textContent = pick(mood.tips);
  document.getElementById('randomNote').textContent = `â€» ç†ä¸å°½ãªè£œæ­£ï¼šã€Œ${event.text}ã€(${event.delta > 0 ? '+' : ''}${event.delta})`;
  const meter = document.getElementById('moodMeter');
  meter.innerHTML = '';
  for (let i = 0; i < 10; i++) {
    const pip = document.createElement('div');
    pip.className = 'mpip' + (i < mood.pips ? (mood.danger ? ' danger' : ' on') : '');
    meter.appendChild(pip);
  }
  const gr = document.getElementById('g-result');
  gr.style.display = 'block';
  gr.scrollIntoView({ behavior: 'smooth' });
  const history = JSON.parse(localStorage.getItem('gil-history') || '[]');
  const now = new Date();
  const date = now.toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' });
  history.unshift({ date, title: mood.title, icon: mood.icon, score: final });
  if (history.length > 7) history.pop();
  localStorage.setItem('gil-history', JSON.stringify(history));
  renderGilHistory();
}

function resetGil() {
  document.querySelectorAll('.gopt').forEach(b => b.classList.remove('selected'));
  Object.keys(gilAnswers).forEach(k => delete gilAnswers[k]);
  gilAnswers['noise'] = 0;
  noiseScore = 0;
  document.getElementById('divineBtn').disabled = true;
  document.getElementById('g-result').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function renderGilHistory() {
  const history = JSON.parse(localStorage.getItem('gil-history') || '[]');
  const el = document.getElementById('gil-history');
  if (history.length === 0) { el.innerHTML = '<div class="no-history">è¨˜éŒ²ãªã—</div>'; return; }
  el.innerHTML = history.map(h => `<div class="g-hitem"><span class="h-date">${h.date}</span><span class="h-mood">${h.icon} ${h.title}</span><span class="h-score">${h.score > 0 ? '+' : ''}${h.score}pt</span></div>`).join('');
}

initGil();
</script>
</body>
</html>
