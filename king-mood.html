<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ç‹ã®æ©Ÿå«Œäºˆå ± â€” æ€ æƒ°ãªé›‘ç¨®ã¨ç‹ã®é¤¨</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Noto+Serif+JP:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root {
  --gold: #c9a84c;
  --gold-light: #f0d080;
  --gold-dim: #7a6030;
  --black: #06060a;
  --dark2: #161420;
  --red: #8b1a1a;
  --text: #e8dcc0;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body {
  font-family: 'Noto Serif JP', serif;
  background: var(--black);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 40% at 50% 0%, #1a1408 0%, transparent 70%),
    repeating-linear-gradient(45deg, transparent, transparent 40px, rgba(201,168,76,0.015) 40px, rgba(201,168,76,0.015) 41px);
  pointer-events: none;
  z-index: 0;
}
.back-btn {
  position: fixed; top: 16px; left: 16px; z-index: 100;
  background: rgba(6,6,10,0.85); border: 1px solid #2a2520;
  color: var(--gold-dim); font-family: 'Noto Serif JP', serif;
  font-size: 0.75rem; letter-spacing: 0.15em;
  padding: 7px 14px; cursor: pointer; transition: all 0.2s;
  backdrop-filter: blur(4px); text-decoration: none; display: inline-block;
}
.back-btn:hover { border-color: var(--gold); color: var(--gold); }
.gil-container {
  max-width: 480px;
  margin: 0 auto;
  padding: 72px 20px 60px;
  position: relative;
  z-index: 1;
}
.gil-header { text-align: center; margin-bottom: 40px; }
.crown { font-size: 2.4rem; display: block; margin-bottom: 8px; filter: drop-shadow(0 0 12px rgba(201,168,76,0.6)); animation: float 3s ease-in-out infinite; }
@keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
.g-title { font-family: 'Cinzel Decorative', serif; font-size: 0.85rem; letter-spacing: 0.3em; color: var(--gold); text-transform: uppercase; margin-bottom: 4px; }
h2.g-h2 { font-size: 1.7rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.15em; text-shadow: 0 0 30px rgba(201,168,76,0.4); }
.g-subtitle { font-size: 0.7rem; color: var(--gold-dim); margin-top: 6px; letter-spacing: 0.2em; }
.g-divider { display: flex; align-items: center; gap: 12px; margin: 28px 0; }
.g-divider::before, .g-divider::after { content: ''; flex: 1; height: 1px; background: linear-gradient(90deg, transparent, var(--gold-dim), transparent); }
.g-divider span { color: var(--gold); font-size: 0.7rem; letter-spacing: 0.2em; white-space: nowrap; }
.q-block { margin-bottom: 22px; }
.q-label { font-size: 0.78rem; color: var(--gold-dim); letter-spacing: 0.15em; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
.q-label::before { content: 'â—†'; color: var(--gold); font-size: 0.5rem; }
.q-hint { font-size: 0.65rem; color: #444; letter-spacing: 0.05em; }
.opts { display: flex; flex-direction: column; gap: 6px; }
.opts.multi { flex-direction: row; flex-wrap: wrap; gap: 6px; }
.gopt {
  background: var(--dark2); border: 1px solid #2a2520; border-radius: 4px;
  padding: 10px 14px; font-size: 0.82rem; font-family: 'Noto Serif JP', serif;
  color: #888; cursor: pointer; transition: all 0.2s; text-align: left; letter-spacing: 0.05em;
}
.opts.multi .gopt { padding: 7px 12px; font-size: 0.78rem; border-radius: 20px; }
.gopt:hover { border-color: var(--gold-dim); color: var(--text); background: #1a1810; }
.gopt.selected { border-color: var(--gold); color: var(--gold-light); background: linear-gradient(90deg, #1e1a0a, #1a1810); box-shadow: 0 0 10px rgba(201,168,76,0.15); }
.divine-btn {
  width: 100%; margin-top: 32px; padding: 16px; background: transparent;
  border: 1px solid var(--gold); color: var(--gold-light); font-family: 'Noto Serif JP', serif;
  font-size: 0.95rem; letter-spacing: 0.3em; cursor: pointer; position: relative;
  overflow: hidden; transition: all 0.3s;
}
.divine-btn::before { content: ''; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(201,168,76,0.08), transparent); transform: translateX(-100%); transition: transform 0.5s; }
.divine-btn:hover::before { transform: translateX(100%); }
.divine-btn:hover { background: rgba(201,168,76,0.06); box-shadow: 0 0 20px rgba(201,168,76,0.2); }
.divine-btn:disabled { border-color: #333; color: #444; cursor: not-allowed; }
.divine-btn:disabled::before { display: none; }
.g-result { display: none; margin-top: 40px; }
.g-frame { border: 1px solid var(--gold-dim); position: relative; padding: 32px 24px; background: linear-gradient(160deg, #100e08, #0e0d10); }
.g-frame::before, .g-frame::after { content: 'â—ˆ'; position: absolute; color: var(--gold); font-size: 0.8rem; }
.g-frame::before { top: -8px; left: -4px; }
.g-frame::after { bottom: -8px; right: -4px; }
.mood-icon { font-size: 3.8rem; display: block; text-align: center; margin-bottom: 12px; animation: gappear 0.5s ease-out; filter: drop-shadow(0 0 16px rgba(201,168,76,0.5)); }
@keyframes gappear { from { transform: scale(0.5) rotate(-10deg); opacity: 0; } to { transform: scale(1) rotate(0); opacity: 1; } }
.mood-title { text-align: center; font-size: 1.4rem; font-weight: 600; color: var(--gold-light); letter-spacing: 0.2em; margin-bottom: 6px; text-shadow: 0 0 20px rgba(201,168,76,0.4); }
.mood-level { text-align: center; font-family: 'Cinzel Decorative', serif; font-size: 0.65rem; color: var(--gold-dim); letter-spacing: 0.3em; margin-bottom: 20px; }
.mood-meter { display: flex; gap: 4px; justify-content: center; margin-bottom: 16px; }
.mpip { width: 20px; height: 4px; background: #222; border-radius: 2px; }
.mpip.on { background: var(--gold); box-shadow: 0 0 6px rgba(201,168,76,0.5); }
.mpip.danger { background: var(--red); box-shadow: 0 0 6px rgba(139,26,26,0.6); }
.random-note { text-align: center; font-size: 0.68rem; color: #4a3f28; margin-bottom: 18px; letter-spacing: 0.08em; font-style: italic; }
.verdict { font-size: 0.88rem; line-height: 2; color: var(--text); text-align: center; margin-bottom: 18px; letter-spacing: 0.05em; white-space: pre-line; }
.gil-quote { border-top: 1px solid #2a2520; padding-top: 16px; font-size: 0.78rem; color: var(--gold-dim); text-align: center; line-height: 1.8; font-style: italic; letter-spacing: 0.1em; }
.gil-quote::before { content: 'ã€Œ'; }
.gil-quote::after { content: 'ã€'; }
.today-tip { margin-top: 16px; padding: 12px; background: rgba(201,168,76,0.04); border-left: 2px solid var(--gold-dim); font-size: 0.78rem; color: #999; line-height: 1.7; letter-spacing: 0.05em; }
.retry-btn { display: block; width: 100%; margin-top: 20px; padding: 10px; background: transparent; border: 1px solid #2a2520; color: #555; font-family: 'Noto Serif JP', serif; font-size: 0.75rem; letter-spacing: 0.2em; cursor: pointer; transition: all 0.2s; }
.retry-btn:hover { border-color: var(--gold-dim); color: var(--gold-dim); }
.g-hist { margin-top: 36px; }
.g-hitem { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #141210; font-size: 0.75rem; }
.g-hitem:last-child { border-bottom: none; }
.h-date { color: #444; }
.h-mood { color: var(--gold-dim); }
.h-score { color: var(--gold); font-size: 0.7rem; }
.no-history { font-size: 0.75rem; color: #333; text-align: center; padding: 12px 0; letter-spacing: 0.1em; }
</style>
</head>
<body>
<a href="index.html" class="back-btn">â† ã‚‚ã©ã‚‹</a>

<div class="gil-container">
  <div class="gil-header">
    <span class="crown">â™›</span>
    <div class="g-title">King's Mood Oracle</div>
    <h2 class="g-h2">ç‹ã®æ©Ÿå«Œäºˆå ±</h2>
    <div class="g-subtitle">â€” ä»Šæ—¥ã®ç‹ã¯ã”æ©Ÿå«Œæ–œã‚ã‹ã€ãã‚Œã¨ã‚‚ â€”</div>
  </div>
  <div class="g-divider"><span>â—† ç¾åœ¨ã®çŠ¶æ³ã‚’ç”³å‘Šã›ã‚ˆ â—†</span></div>

  <div class="q-block">
    <div class="q-label">ä»Šæ—¥ã®å¤©æ°—</div>
    <div class="opts single" data-q="weather">
      <button class="gopt" data-v="2">â˜€ï¸ æ™´ã‚Œï¼ˆç‹ã®é»„é‡‘ã®å¦‚ã—ï¼‰</button>
      <button class="gopt" data-v="1">â›… æ›‡ã‚Š</button>
      <button class="gopt" data-v="-1">ğŸŒ§ï¸ é›¨ï¼ˆé¬±é™¶ã—ã„ï¼‰</button>
      <button class="gopt" data-v="0">ğŸŒ©ï¸ åµï¼ˆç‹ã¯åµã‚’å¥½ã‚€ï¼‰</button>
    </div>
  </div>
  <div class="q-block">
    <div class="q-label">ä»Šæ—¥ã®è‡ªåˆ†ã®å‡ºæ¥æ „ãˆ</div>
    <div class="opts single" data-q="self">
      <button class="gopt" data-v="3">å®Œç’§ã ã£ãŸï¼ˆç‹ã«è¿‘ã„ï¼‰</button>
      <button class="gopt" data-v="1">ã¾ã‚ã¾ã‚ã ã£ãŸ</button>
      <button class="gopt" data-v="-1">ã ã‚ã ã‚ã ã£ãŸ</button>
      <button class="gopt" data-v="-3">èããª</button>
    </div>
  </div>
  <div class="q-block">
    <div class="q-label">ä»Šæ—¥ã®é›‘å¿µ <span class="q-hint">ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</span></div>
    <div class="opts multi" data-q="noise">
      <button class="gopt" data-v="3">Twitterã§æ¨ã—ã®ä¾›çµ¦ãŒã‚ã£ãŸ</button>
      <button class="gopt" data-v="-2">SNSã§ä¸æ¯›ãªè­°è«–ã‚’è¦‹ãŸ</button>
      <button class="gopt" data-v="-1">å«Œãªã“ã¨ãŒã‚ã£ãŸ</button>
      <button class="gopt" data-v="1">é™ã‹ãªä¸€æ—¥ã ã£ãŸ</button>
      <button class="gopt" data-v="-3">åœ°é›·ã‚’è¸ã‚“ã </button>
      <button class="gopt" data-v="2">è‰¯ã„ã”é£¯ã‚’é£Ÿã¹ãŸ</button>
      <button class="gopt" data-v="-1">çœ ã„</button>
      <button class="gopt" data-v="2">å‰µä½œãŒæ—ã£ãŸ</button>
      <button class="gopt" data-v="-2">æ¨ã—ãŒå…¬å¼ã§é›‘ã«æ‰±ã‚ã‚Œã¦ã„ãŸ</button>
      <button class="gopt" data-v="1">ã„ã„å¤¢ã‚’è¦‹ãŸ</button>
      <button class="gopt" data-v="-1">é ­ç—›ãŒã™ã‚‹</button>
      <button class="gopt" data-v="3">ç¥çµµå¸«ã®ç¥çµµã‚’è¦‹ãŸ</button>
      <button class="gopt" data-v="-2">èª²é‡‘ã—ãŸï¼ˆå¾Œæ‚”ã‚ã‚Šï¼‰</button>
      <button class="gopt" data-v="2">èª²é‡‘ã—ãŸï¼ˆå¾Œæ‚”ãªã—ï¼‰</button>
      <button class="gopt" data-v="-1">ãªã‚“ã‹è™šç„¡</button>
      <button class="gopt" data-v="1">ã‚³ãƒ¼ãƒ’ãƒ¼ãŒã†ã¾ã‹ã£ãŸ</button>
      <button class="gopt" data-v="-2">æ¨ã—ã‚«ãƒ—ã®NLãŒæµã‚Œã¦ããŸ</button>
      <button class="gopt" data-v="2">å¸ƒå›£ãŒæ°—æŒã¡ã‚ˆã‹ã£ãŸ</button>
      <button class="gopt" data-v="-1">èª¤å­—ã—ãŸ</button>
      <button class="gopt" data-v="1">è‰¯ã„BGMã‚’è¦‹ã¤ã‘ãŸ</button>
    </div>
  </div>
  <div class="q-block">
    <div class="q-label">ä»Šæ—¥ã®ç‹ï¼ˆã‚®ãƒ«ã‚¬ãƒ¡ãƒƒã‚·ãƒ¥ï¼‰ã¸ã®è²¢ãç‰©</div>
    <div class="opts single" data-q="tribute">
      <button class="gopt" data-v="4">åŒäººèªŒãƒ»ã‚°ãƒƒã‚ºã‚’ä½œã£ãŸ or è¦‹ãŸ</button>
      <button class="gopt" data-v="2">äºŒæ¬¡å‰µä½œã‚’Twitterã§æ˜ã£ãŸ</button>
      <button class="gopt" data-v="0">å­˜åœ¨ã‚’æ€ã„å‡ºã—ãŸç¨‹åº¦</button>
      <button class="gopt" data-v="-2">ä»Šæ—¥ã¯ä»–ã®æ¨ã—ã«æµ®æ°—ã—ãŸ</button>
    </div>
  </div>
  <div class="q-block">
    <div class="q-label">ä»Šã®æ™‚é–“å¸¯</div>
    <div class="opts single" data-q="time">
      <button class="gopt" data-v="1">æœï¼ˆç‹ã¯å¤œæ˜ã‘ã‚’å«Œã†ï¼‰</button>
      <button class="gopt" data-v="2">æ˜¼ï¼ˆé»„é‡‘ã®æ™‚ï¼‰</button>
      <button class="gopt" data-v="1">å¤•æ–¹</button>
      <button class="gopt" data-v="3">æ·±å¤œï¼ˆçœŸã®ç‹ã¯å¤œã«èªã‚‹ï¼‰</button>
    </div>
  </div>

  <button class="divine-btn" id="divineBtn" onclick="divine()" disabled>â—† &nbsp;ç‹ã®æ©Ÿå«Œã‚’å ã†&nbsp; â—†</button>

  <div class="g-result" id="g-result">
    <div class="g-frame">
      <span class="mood-icon" id="moodIcon"></span>
      <div class="mood-title" id="moodTitle"></div>
      <div class="mood-level" id="moodLevel"></div>
      <div class="mood-meter" id="moodMeter"></div>
      <div class="random-note" id="randomNote"></div>
      <div class="verdict" id="verdict"></div>
      <div class="gil-quote" id="gilQuote"></div>
      <div class="today-tip" id="todayTip"></div>
    </div>
    <button class="retry-btn" onclick="resetGil()">â€” ã‚‚ã†ä¸€åº¦å ã† â€”</button>
  </div>

  <div class="g-hist">
    <div class="g-divider"><span>â—† éå»ã®å¾¡æ©Ÿå«Œ â—†</span></div>
    <div id="gil-history"></div>
  </div>
</div>

<script>
const randomEvents = [
  { text: 'ä»Šæ—¥ã¯æœˆãŒæ¬ ã‘ã¦ã„ã‚‹', delta: -3 },
  { text: 'ç‹ã®æ°—åˆ†ãŒå®‡å®™ã®æ³•å‰‡ã«å¾“ã„æ‚ªåŒ–ã—ãŸ', delta: -5 },
  { text: 'èª°ã‹ãŒç‹ã®åã‚’å‘¼ã³æ¨ã¦ã«ã—ãŸï¼ˆã©ã“ã‹ã§ï¼‰', delta: -4 },
  { text: 'ç©ºæ°—ã®æ¹¿åº¦ãŒç‹ã®å¥½ã¿ã§ã¯ãªã„', delta: -2 },
  { text: 'ç¥ã€…ãŒä»Šæ—¥ã®ç‹ã«å¾®ç¬‘ã‚“ã ', delta: +4 },
  { text: 'ç‹ã®è²¡å®åº«ãŒä»Šæ—¥ã‚‚å®Œç’§ã§ã‚ã‚‹', delta: +3 },
  { text: 'è‹±é›„ãŒä¸€äººã©ã“ã‹ã§æˆ¦ã„ã‚’æŒ‘ã‚“ã§ã„ã‚‹ï¼ˆç‹ã¯èˆˆå‘³ãªã—ï¼‰', delta: -1 },
  { text: 'ç‰¹ã«ä½•ã‚‚ãªã„ã€‚ã ã‹ã‚‰ã“ãé€€å±ˆ', delta: -2 },
  { text: 'ç‹ã¯ä»Šæ—¥ã€å·±ã®å®Œç’§ã•ã‚’å†ç¢ºèªã—ãŸ', delta: +5 },
  { text: 'ã‚¨ãƒ«ã‚­ãƒ‰ã‚¥ã®å¤¢ã‚’è¦‹ãŸï¼ˆç‹ã¯å¦å®šã™ã‚‹ï¼‰', delta: -3 },
  { text: 'é›‘ç¨®ã©ã‚‚ãŒé¨’ãŒã—ã„', delta: -3 },
  { text: 'ä»Šæ—¥ã®æ˜Ÿã®ä¸¦ã³ãŒç‹ã‚’è®ƒãˆã¦ã„ã‚‹', delta: +4 },
  { text: 'èª°ã‹ãŒç‹ã‚’ã€Œã‚®ãƒ«ãã‚“ã€ã¨å‘¼ã‚“ã ', delta: -6 },
  { text: 'ç‹ã®é£Ÿäº‹ãŒä»Šæ—¥ã¯ç‰¹ã«è±ªå‹¢ã ã£ãŸ', delta: +3 },
  { text: 'ä½•è€…ã‹ãŒç‹ã®å‰ä¸–ã‚’è©®ç´¢ã—ãŸ', delta: -4 },
  { text: 'é¢¨ãŒä»Šæ—¥ã¯æ°—æŒã¡ã‚ˆã‹ã£ãŸ', delta: +2 },
  { text: 'ç‹ã®é»„é‡‘é§ã®è¼ããŒå¢—ã—ãŸï¼ˆæ°—ãŒã™ã‚‹ï¼‰', delta: +3 },
  { text: 'ãƒãƒ“ãƒ­ãƒ³ãŒä»Šæ—¥ã‚‚ç¾ã—ã„', delta: +2 },
  { text: 'èª°ã‹ãŒè‹±é›„ç‹ã®åŠŸç¸¾ã‚’ã€Œæ„å¤–ã¨çŸ¥ã‚‰ãªã„ã€ã¨è¨€ã£ãŸ', delta: -5 },
  { text: 'ä»Šæ—¥ã¯ãªãœã‹å…¨ã¦ãŒã©ã†ã§ã‚‚ã‚ˆã„', delta: -4 },
];

const moods = [
  { min: -999, max: -5, icon: 'âš”ï¸', title: 'çƒˆç«ã®æ€’ã‚Š', level: 'WRATH MODE', pips: 10, danger: true,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€åœ°ä¸Šã®å…¨ã¦ã«é£½ã„ã¦ãŠã‚‰ã‚Œã‚‹ã€‚\nå­˜åœ¨ã™ã‚‹ã ã‘ã§æ°—ã«éšœã‚‹ã‚‰ã—ã„ã€‚','è¿‘å¯„ã‚‹ãªã€‚ç‹ã®æ€’ã‚Šã¯ä»Šæ—¥ã€å®‡å®™è¦æ¨¡ã§ã‚ã‚‹ã€‚','æ©Ÿå«ŒãŒæ‚ªã„ã¨ã„ã†ãƒ¬ãƒ™ãƒ«ã§ã¯ãªã„ã€‚\nç‹ãŒã€Œä¸–ç•Œã”ã¨çµ‚ã‚ã‚‰ã›ã‚ˆã†ã€ã¨æ€ã£ã¦ã„ã‚‹é¡”ã‚’ã—ã¦ã„ã‚‹ã€‚'],
    quotes: ['é›‘ç¨®ã‚ã€ãã®ç¨‹åº¦ã§æˆ‘ã«è©±ã—ã‹ã‘ã‚‹ã¨ã¯ç¬‘æ­¢','ä»Šæ—¥ã®æˆ‘ã«è©±ã—ã‹ã‘ã‚‹ã“ã¨ã¯æ­»ã«ç­‰ã—ã„','ã“ã®ä¸–ã®å…¨ã¦ãŒæ°—ã«é£Ÿã‚ãªã„ã€‚å½“ç„¶ã ãŒ'],
    tips: ['âš  ä»Šæ—¥ã¯çµ¶å¯¾ã«è¿‘ã¥ã‹ãªã„ã“ã¨ã€‚æ¨ã—æ´»ã¯æ˜æ—¥ã«ã—ã‚ã€‚'] },
  { min: -4, max: 2, icon: 'ğŸ˜’', title: 'ä¸æ©Ÿå«Œ', level: 'LOW TOLERANCE', pips: 3, danger: true,
    verdicts: ['ç‹ã¯ä¸æº€è¶³ã®çŠ¶æ…‹ã«ã‚ã‚‹ã€‚\nä½•ã‹ãŒè¶³ã‚Šãªã„ã€‚è²¢ãç‰©ãŒè¶³ã‚Šãªã„ã€‚','ç‹ã®çœ‰é–“ã«ã—ã‚ãŒå¯„ã£ã¦ã„ã‚‹ã€‚\nä»Šæ—¥ã¯ä½•ã‚’ã‚„ã£ã¦ã‚‚è¤’ã‚ã‚‰ã‚Œãªã„æ—¥ã ã€‚','ã¾ãšã„ã€‚ç‹ãŒã€Œã¤ã¾ã‚‰ã¬ã€ã¨è¨€ã„å§‹ã‚ãŸã€‚'],
    quotes: ['æˆ‘ã‚’æ¥½ã—ã¾ã›ã¦ã¿ã‚ˆã€ã§ãã‚‹ãªã‚‰ã°','è²¢ãç‰©ãŒè¶³ã‚Šã¬','ã“ã®ç¨‹åº¦ã‹'],
    tips: ['âš¡ è‰¯ã„äºŒæ¬¡å‰µä½œã‚’è¦‹ã‚‹ã‹ã€æ¨ã—èªã‚Šã‚’ã™ã‚‹ã‹ã€‚ã¨ã«ã‹ãä½•ã‹ã‚’æ§ã’ã‚ˆã€‚'] },
  { min: 3, max: 9, icon: 'ğŸ˜', title: 'ã‚„ã‚„é€€å±ˆ', level: 'MILD BOREDOM', pips: 5, danger: false,
    verdicts: ['æ‚ªãã¯ãªã„ãŒã€è‰¯ãã‚‚ãªã„ã€‚\nç‹ã®åŸºæº–ã§ã¯ã€Œæ™®é€šã€ä»¥ä¸‹ã§ã‚ã‚‹ã€‚','ç‹ã¯ä»Šæ—¥ã€é€€å±ˆã—ã¦ã„ã‚‹ã€‚\né€€å±ˆãªç‹ã¯å±é™ºã ãŒã€ã¾ã çˆ†ç™ºã¯ã—ãªã„ã€‚','å‡ªã®çŠ¶æ…‹ã€‚\nåµã®å‰ãªã®ã‹ã€ãŸã ã®ç„¡é¢¨ãªã®ã‹ã¯ç‹ã®ã¿ãçŸ¥ã‚‹ã€‚'],
    quotes: ['ã¾ã‚ã€æ‚ªãã¯ãªã„ãª','é¢ç™½ã„ã‚‚ã®ã‚’é€£ã‚Œã¦ã“ã„','ãµã‚€â€¦'],
    tips: ['ğŸ“œ æ™®é€šã®æ—¥ã€‚æ¨ã—ã®ã“ã¨ã‚’è€ƒãˆãªãŒã‚‰éã”ã™ã¨å‰ã€‚'] },
  { min: 10, max: 16, icon: 'ğŸ˜', title: 'ã¾ãšã¾ãš', level: 'ACCEPTABLE', pips: 7, danger: false,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€æ¯”è¼ƒçš„ç©ã‚„ã‹ã§ã‚ã‚‹ã€‚\nã“ã‚Œã¯åƒè¼‰ä¸€é‡ã®ãƒãƒ£ãƒ³ã‚¹ã‹ã‚‚ã—ã‚Œãªã„ã€‚','ç‹ã®å£è§’ãŒã‚ãšã‹ã«ä¸ŠãŒã£ã¦ã„ã‚‹ã€‚\nä»Šæ—¥ã¯æ¨ã—æ´»ã«çµ¶å¥½ã®æ—¥ã ã€‚','ä¸Šæ©Ÿå«Œã¨ã¯è¨€ãˆãªã„ãŒã€ä¸æ©Ÿå«Œã§ã‚‚ãªã„ã€‚\nç‹ã®ã”åŠ è­·ãŒè–„ãã‹ã‹ã£ã¦ã„ã‚‹çŠ¶æ…‹ã€‚'],
    quotes: ['ä»Šæ—¥ã®æˆ‘ã¯æ°—åˆ†ãŒã„ã„ã€‚æ„Ÿè¬ã™ã‚‹ãŒã„ã„','ãµã€ã‚ˆãã‚„ã£ãŸ','æ‚ªããªã„ã€‚ç¶šã‘ã‚ˆ'],
    tips: ['âœ¨ ãƒãƒ£ãƒ³ã‚¹ã®æ—¥ï¼å‰µä½œæ´»å‹•ã‚„æ¨ã—æ´»ã«å‘ã„ã¦ã„ã‚‹ã€‚'] },
  { min: 17, max: 999, icon: 'ğŸ‘‘', title: 'çµ¶å¥½èª¿ãƒ»ç‹è€…ã®é¢¨æ ¼', level: 'MAXIMUM GILGAMESH', pips: 10, danger: false,
    verdicts: ['ç‹ã¯ä»Šæ—¥ã€å…¨ã¦ã‚’è‚¯å®šã—ã¦ã„ã‚‹ã€‚\nä¸–ç•Œã¯ç‹ã®ãŸã‚ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã¨ç¢ºä¿¡ã—ã¦ã„ã‚‹ã€‚','å®Œç’§ãªæ©Ÿå«Œã€‚\nç‹ãŒç¬‘ã£ã¦ã„ã‚‹ã€‚ã“ã®å…‰æ™¯ã¯åƒå¹´ã«ä¸€åº¦ã—ã‹è¦‹ã‚‰ã‚Œãªã„ã€‚','ä»Šæ—¥ã®ç‹ã¯ç„¡æ•µã ã€‚\nå¤ªé™½ã‚‚ç‹ã‚’è®ƒãˆã‚‹ãŸã‚ã«è¼ã„ã¦ã„ã‚‹ï¼ˆç‹è«‡ï¼‰ã€‚'],
    quotes: ['ãƒ•ãƒãƒã€ä»Šæ—¥ã®æˆ‘ã¯å®Œç’§ã ã€‚å½“ç„¶ã ãŒ','ä¸–ç•Œã‚ˆã€ã“ã‚ŒãŒç‹ã®æ©Ÿå«Œã¨ã„ã†ã‚‚ã®ã ','æˆ‘ãŒç¬‘ã£ã¦ã„ã‚‹ã†ã¡ã«ã€ä½•ã§ã‚‚ç”³ã—ã¦ã¿ã‚ˆ'],
    tips: ['ğŸŒŸ æœ€é«˜ã®æ—¥ï¼ä½•ã‚’ã‚„ã£ã¦ã‚‚ç‹ã®åŠ è­·ãŒã‚ã‚‹ã€‚é‡ã„äºŒæ¬¡å‰µä½œã‚‚èŒãˆèŒãˆãªåŒäººã‚‚å…¨éƒ¨OKã€‚'] },
];

function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

const gilAnswers = {};
let noiseScore = 0;

document.querySelectorAll('.opts.single').forEach(group => {
  group.querySelectorAll('.gopt').forEach(btn => {
    btn.addEventListener('click', () => {
      group.querySelectorAll('.gopt').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
      gilAnswers[group.dataset.q] = parseInt(btn.dataset.v);
      checkReady();
    });
  });
});
document.querySelector('.opts.multi').querySelectorAll('.gopt').forEach(btn => {
  btn.addEventListener('click', () => {
    btn.classList.toggle('selected');
    noiseScore = [...document.querySelectorAll('.opts.multi .gopt.selected')].reduce((s, b) => s + parseInt(b.dataset.v), 0);
    gilAnswers['noise'] = noiseScore;
    checkReady();
  });
});
gilAnswers['noise'] = 0;

function checkReady() {
  const ready = ['weather','self','tribute','time'].every(q => gilAnswers[q] !== undefined);
  document.getElementById('divineBtn').disabled = !ready;
}

function divine() {
  const event = pick(randomEvents);
  const base = Object.values(gilAnswers).reduce((a,b) => a+b, 0);
  const final = base + event.delta;
  const mood = moods.find(m => final >= m.min && final <= m.max);
  document.getElementById('moodIcon').textContent = mood.icon;
  document.getElementById('moodTitle').textContent = mood.title;
  document.getElementById('moodLevel').textContent = mood.level;
  document.getElementById('verdict').textContent = pick(mood.verdicts);
  document.getElementById('gilQuote').textContent = pick(mood.quotes);
  document.getElementById('todayTip').textContent = pick(mood.tips);
  document.getElementById('randomNote').textContent = `â€» ç†ä¸å°½ãªè£œæ­£ï¼šã€Œ${event.text}ã€(${event.delta > 0 ? '+' : ''}${event.delta})`;
  const meter = document.getElementById('moodMeter');
  meter.innerHTML = '';
  for (let i = 0; i < 10; i++) {
    const pip = document.createElement('div');
    pip.className = 'mpip' + (i < mood.pips ? (mood.danger ? ' danger' : ' on') : '');
    meter.appendChild(pip);
  }
  const gr = document.getElementById('g-result');
  gr.style.display = 'block';
  gr.scrollIntoView({ behavior: 'smooth' });
  const history = JSON.parse(localStorage.getItem('gil-history') || '[]');
  const now = new Date();
  const date = now.toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' });
  history.unshift({ date, title: mood.title, icon: mood.icon, score: final });
  if (history.length > 7) history.pop();
  localStorage.setItem('gil-history', JSON.stringify(history));
  renderHistory();
}

function resetGil() {
  document.querySelectorAll('.gopt').forEach(b => b.classList.remove('selected'));
  Object.keys(gilAnswers).forEach(k => delete gilAnswers[k]);
  gilAnswers['noise'] = 0;
  noiseScore = 0;
  document.getElementById('divineBtn').disabled = true;
  document.getElementById('g-result').style.display = 'none';
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function renderHistory() {
  const history = JSON.parse(localStorage.getItem('gil-history') || '[]');
  const el = document.getElementById('gil-history');
  if (history.length === 0) { el.innerHTML = '<div class="no-history">è¨˜éŒ²ãªã—</div>'; return; }
  el.innerHTML = history.map(h => `<div class="g-hitem"><span class="h-date">${h.date}</span><span class="h-mood">${h.icon} ${h.title}</span><span class="h-score">${h.score > 0 ? '+' : ''}${h.score}pt</span></div>`).join('');
}

renderHistory();
</script>
</body>
</html>
