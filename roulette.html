<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='80'>âœ¦</text></svg>">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ˜¼ã”ã¯ã‚“ãƒ«ãƒ¼ãƒ¬ãƒƒãƒˆ â€” æ€ æƒ°ãªé›‘ç¨®ã¨ç‹ã®é¤¨</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
<style>*{margin:0;padding:0;box-sizing:border-box;}body{background:linear-gradient(135deg,#1a0533 0%,#0d1b4b 50%,#1a0533 100%);min-height:100vh;}.back-link{position:fixed;top:16px;left:16px;z-index:100;color:rgba(255,107,157,0.6);font-size:0.75rem;text-decoration:none;font-family:'Noto Sans JP',sans-serif;letter-spacing:0.1em;transition:color 0.2s;}.back-link:hover{color:#ff6b9d;}</style>
</head>
<body>
<a href="index.html" class="back-link">â† ã‚‚ã©ã‚‹</a>
<div id="root"></div>
<script type="text/babel">
const{useState,useRef,useEffect}=React;
const DEFAULT_ITEMS=["ãƒ©ãƒ¼ãƒ¡ãƒ³","ã‚«ãƒ¬ãƒ¼","ãƒ‘ã‚¹ã‚¿","å¯¿å¸","ç„¼è‚‰","ã†ã©ã‚“","ãƒ”ã‚¶","å®šé£Ÿ"];
const COLORS=["#ff6b9d","#ff9a5c","#ffd166","#06d6a0","#118ab2","#9b5de5","#f72585","#4cc9f0","#ff6b9d","#ffd166","#9b5de5","#06d6a0","#ff9a5c","#4cc9f0","#f72585","#118ab2"];
function Roulette(){
  const[items,setItems]=useState(DEFAULT_ITEMS);
  const[newItem,setNewItem]=useState("");
  const[spinning,setSpinning]=useState(false);
  const[result,setResult]=useState(null);
  const[showEdit,setShowEdit]=useState(false);
  const[showConfirm,setShowConfirm]=useState(false);
  const canvasRef=useRef(null);
  const rotRef=useRef(0);
  useEffect(()=>{drawWheel(rotRef.current);},[items]);
  function drawWheel(rot){
    const canvas=canvasRef.current;if(!canvas)return;
    const ctx=canvas.getContext("2d");const W=canvas.width,H=canvas.height;
    const cx=W/2,cy=H/2,r=cx-10;const n=items.length;
    ctx.clearRect(0,0,W,H);if(n===0)return;
    const slice=(Math.PI*2)/n;
    for(let i=0;i<n;i++){
      const a1=rot+i*slice-Math.PI/2;const a2=a1+slice;
      ctx.beginPath();ctx.moveTo(cx,cy);ctx.arc(cx,cy,r,a1,a2);ctx.closePath();
      ctx.fillStyle=COLORS[i%COLORS.length];ctx.fill();
      ctx.strokeStyle="rgba(255,255,255,0.2)";ctx.lineWidth=1.5;ctx.stroke();
      ctx.save();ctx.translate(cx,cy);ctx.rotate(a1+slice/2);ctx.textAlign="right";
      ctx.fillStyle="#fff";ctx.font=`bold ${Math.min(15,180/n)}px 'Noto Sans JP',sans-serif`;
      ctx.shadowColor="rgba(0,0,0,0.5)";ctx.shadowBlur=4;ctx.fillText(items[i],r-10,5);ctx.restore();
    }
    const g=ctx.createRadialGradient(cx,cy,0,cx,cy,22);
    g.addColorStop(0,"#fff");g.addColorStop(1,"#f9d0e8");
    ctx.beginPath();ctx.arc(cx,cy,22,0,Math.PI*2);
    ctx.fillStyle=g;ctx.shadowColor="#ff6b9d";ctx.shadowBlur=10;ctx.fill();
  }
  function getWinner(rot){
    const n=items.length;const slice=(Math.PI*2)/n;
    const angle=((-rot)%(Math.PI*2)+Math.PI*2)%(Math.PI*2);
    return Math.floor(angle/slice)%n;
  }
  function spin(){
    if(spinning||items.length<2)return;
    setResult(null);setSpinning(true);
    const totalRot=Math.PI*2*(6+Math.random()*5)+Math.random()*Math.PI*2;
    const duration=3000+Math.random()*1000;const t0=performance.now();const r0=rotRef.current;
    const ease=t=>1-Math.pow(1-t,4);
    function frame(now){
      const t=Math.min((now-t0)/duration,1);
      rotRef.current=r0+totalRot*ease(t);drawWheel(rotRef.current);
      if(t<1){requestAnimationFrame(frame);return;}
      setSpinning(false);setResult(items[getWinner(rotRef.current)]);
    }
    requestAnimationFrame(frame);
  }
  function addItem(){if(newItem.trim()&&items.length<16){setItems([...items,newItem.trim()]);setNewItem("");}}
  return(
    <div style={{minHeight:"100vh",background:"linear-gradient(135deg,#1a0533 0%,#0d1b4b 50%,#1a0533 100%)",fontFamily:"'Noto Sans JP',sans-serif",color:"#fff",padding:"32px 20px 60px",position:"relative",overflow:"hidden"}}>
      <div style={{position:"fixed",inset:0,zIndex:0,pointerEvents:"none",backgroundImage:"linear-gradient(rgba(255,107,157,0.07) 1px,transparent 1px),linear-gradient(90deg,rgba(255,107,157,0.07) 1px,transparent 1px)",backgroundSize:"40px 40px",transform:"perspective(500px) rotateX(35deg) scaleY(2.5) translateY(35%)",transformOrigin:"bottom"}}/>
      {showConfirm&&(<div style={{position:"fixed",inset:0,zIndex:100,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center"}}><div style={{background:"linear-gradient(135deg,#1a0533,#0d1b4b)",border:"1px solid rgba(255,107,157,0.4)",borderRadius:16,padding:"28px 24px",maxWidth:280,width:"90%",textAlign:"center"}}><div style={{fontSize:"1.8rem",marginBottom:12}}>ğŸ—‘</div><div style={{fontSize:"0.9rem",color:"rgba(255,255,255,0.8)",marginBottom:6}}>å…¨éƒ¨æ¶ˆã—ã¾ã™ã‹ï¼Ÿ</div><div style={{fontSize:"0.72rem",color:"rgba(255,255,255,0.35)",marginBottom:20}}>ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“</div><div style={{display:"flex",gap:10}}><button onClick={()=>setShowConfirm(false)} style={{flex:1,padding:10,background:"transparent",border:"1px solid rgba(255,255,255,0.2)",borderRadius:8,color:"rgba(255,255,255,0.5)",fontSize:"0.8rem",cursor:"pointer"}}>ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button><button onClick={()=>{setItems([]);setResult(null);setShowConfirm(false);}} style={{flex:1,padding:10,background:"linear-gradient(135deg,#ff3366,#9b1de0)",border:"none",borderRadius:8,color:"#fff",fontSize:"0.8rem",fontWeight:700,cursor:"pointer"}}>æ¶ˆã™</button></div></div></div>)}
      <div style={{position:"relative",zIndex:1,maxWidth:440,margin:"0 auto",paddingTop:32}}>
        <div style={{textAlign:"center",marginBottom:24}}>
          <div style={{fontSize:"0.6rem",letterSpacing:"0.5em",color:"#ff6b9d",marginBottom:8,opacity:0.8}}>âœ¦ CITY ROULETTE âœ¦</div>
          <h1 style={{fontSize:"2.6rem",fontFamily:"'Pacifico',cursive",fontWeight:400,marginBottom:6,background:"linear-gradient(90deg,#ff6b9d,#ffd166,#9b5de5)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",lineHeight:1.2}}>Roulette</h1>
          <div style={{fontSize:"0.65rem",color:"rgba(255,255,255,0.35)",letterSpacing:"0.25em"}}>é‹å‘½ã«å¾“ãˆ</div>
        </div>
        <div style={{position:"relative",display:"flex",justifyContent:"center",marginBottom:6}}>
          <div style={{position:"absolute",top:-4,left:"50%",transform:"translateX(-50%)",zIndex:10,width:0,height:0,borderLeft:"10px solid transparent",borderRight:"10px solid transparent",borderTop:"26px solid #ffd166",filter:"drop-shadow(0 2px 8px rgba(255,209,102,0.9))"}}/>
          <canvas ref={canvasRef} width={290} height={290} style={{borderRadius:"50%",cursor:spinning?"default":"pointer",boxShadow:"0 0 40px rgba(255,107,157,0.25)"}} onClick={spin}/>
        </div>
        <div style={{textAlign:"center",minHeight:52,marginBottom:16,display:"flex",alignItems:"center",justifyContent:"center"}}>
          {result&&!spinning&&(<div style={{background:"linear-gradient(135deg,rgba(255,107,157,0.15),rgba(155,93,229,0.15))",border:"1px solid rgba(255,107,157,0.5)",borderRadius:12,padding:"11px 28px",fontSize:"1.15rem",fontWeight:700,color:"#ffd166",textShadow:"0 0 14px rgba(255,209,102,0.7)",letterSpacing:"0.1em"}}>âœ¦ {result} âœ¦</div>)}
        </div>
        <button onClick={spin} disabled={spinning||items.length<2} style={{width:"100%",padding:16,background:spinning?"rgba(255,255,255,0.05)":"linear-gradient(135deg,#ff6b9d,#9b5de5)",border:"none",borderRadius:12,color:"#fff",fontSize:"1rem",fontWeight:700,letterSpacing:"0.2em",cursor:spinning?"default":"pointer",boxShadow:spinning?"none":"0 4px 24px rgba(255,107,157,0.45)",marginBottom:12}}>{spinning?"âœ¦ æ±ºå®šä¸­... âœ¦":"â–¶ SPIN"}</button>
        <button onClick={()=>setShowEdit(!showEdit)} style={{width:"100%",padding:10,background:"transparent",border:"1px solid rgba(255,255,255,0.15)",borderRadius:8,color:"rgba(255,255,255,0.45)",fontSize:"0.75rem",letterSpacing:"0.2em",cursor:"pointer",marginBottom:showEdit?14:0}}>{showEdit?"â–² é–‰ã˜ã‚‹":"âœ é …ç›®ã‚’ç·¨é›†ã™ã‚‹"}</button>
        {showEdit&&(<div style={{background:"rgba(255,255,255,0.04)",border:"1px solid rgba(255,255,255,0.1)",borderRadius:12,padding:16}}>
          <div style={{display:"flex",gap:8,marginBottom:12}}>
            <input value={newItem} onChange={e=>setNewItem(e.target.value)} onKeyDown={e=>e.key==="Enter"&&addItem()} placeholder="é …ç›®ã‚’è¿½åŠ  ..." maxLength={20} style={{flex:1,background:"rgba(255,255,255,0.08)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:8,padding:"9px 12px",color:"#fff",fontSize:"0.82rem",fontFamily:"inherit"}}/>
            <button onClick={addItem} disabled={!newItem.trim()||items.length>=16} style={{padding:"9px 16px",background:"linear-gradient(135deg,#ff6b9d,#9b5de5)",border:"none",borderRadius:8,color:"#fff",fontSize:"0.9rem",cursor:"pointer",fontWeight:700}}>+</button>
          </div>
          <div style={{display:"flex",flexWrap:"wrap",gap:6,marginBottom:12}}>
            {items.map((item,i)=>(<div key={i} style={{display:"flex",alignItems:"center",gap:5,background:`${COLORS[i%COLORS.length]}22`,border:`1px solid ${COLORS[i%COLORS.length]}66`,borderRadius:20,padding:"4px 8px 4px 12px",fontSize:"0.76rem"}}><span>{item}</span><button onClick={()=>setItems(items.filter((_,j)=>j!==i))} style={{background:"none",border:"none",color:"rgba(255,255,255,0.4)",cursor:"pointer",fontSize:"0.72rem",padding:0,lineHeight:1}}>âœ•</button></div>))}
            {items.length===0&&<div style={{fontSize:"0.72rem",color:"rgba(255,255,255,0.25)"}}>é …ç›®ãŒã‚ã‚Šã¾ã›ã‚“</div>}
          </div>
          <div style={{display:"flex",gap:8,borderTop:"1px solid rgba(255,255,255,0.08)",paddingTop:12}}>
            <button onClick={()=>setShowConfirm(true)} style={{flex:1,padding:8,background:"rgba(255,51,102,0.12)",border:"1px solid rgba(255,51,102,0.3)",borderRadius:8,color:"rgba(255,130,150,0.9)",fontSize:"0.72rem",letterSpacing:"0.1em",cursor:"pointer"}}>ğŸ—‘ å…¨éƒ¨æ¶ˆã™</button>
            <button onClick={()=>{setItems(DEFAULT_ITEMS);setResult(null);}} style={{flex:1,padding:8,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(255,255,255,0.15)",borderRadius:8,color:"rgba(255,255,255,0.4)",fontSize:"0.72rem",letterSpacing:"0.1em",cursor:"pointer"}}>â†© ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™</button>
          </div>
          {items.length>=16&&<div style={{fontSize:"0.68rem",color:"rgba(255,255,255,0.3)",marginTop:8}}>æœ€å¤§16é …ç›®ã¾ã§</div>}
        </div>)}
      </div>
    </div>
  );
}
ReactDOM.createRoot(document.getElementById('root')).render(<Roulette/>);
</script>
</body>
</html>
